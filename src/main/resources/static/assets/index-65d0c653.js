import{b as A,c as F,d as M,e as W,f as R,h as j,_ as q}from"./_plugin-vue_export-helper-e6061c00.js";import{b as G,r,v as H,o as J,e as u,h as K,l as c,i as e,w as t,F as O,f as P,s as d,x as Q,E as i,y as k,p as X,n as Y}from"./index-b1128ddc.js";const Z=f=>(X("data-v-db73055a"),f=f(),Y(),f),ee={class:"container"},ae={class:"box"},te={class:"card-header"},le=Z(()=>c("h2",null,"分区设置",-1)),oe={m:"4"},se={class:"dialog-footer"},ne={class:"dialog-footer"},de=G({__name:"index",setup(f){const b=r(""),p=r(!1),m=r("");let h=r([]);const T=H(()=>h.value.filter(l=>!b.value||l.value.toLowerCase().includes(b.value.toLowerCase()))),v=r(!1);let x;const N=l=>{v.value=!0,x=l.value,B(l.value)};let C=r([]);const B=async l=>{const a=await F(l,"1");a.status==200&&(C.value=a.data)},w=r([]),$=l=>{w.value=l},I=async()=>{await M({comboId:x,devices:w.value}),await _(),v.value=!1},S=async()=>{if(L(m.value)){const a=await W(m.value);a.status==200?_():i.error(a.message)}p.value=!1},z=async(l,a)=>{k.confirm("将删除分区"+a.value+"，是否继续？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await R(a.value),_(),i({type:"success",message:"删除成功"})}catch(n){i.error("删除分区失败："+n.message)}}).catch(()=>{i({type:"info",message:"Delete canceled"})})},E=async(l,a)=>{k.confirm("将删除设备"+a.deviceName+"，是否继续？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await j(a.deviceName),_(),i({type:"success",message:"删除成功"})}catch(n){i.error("删除失败："+n.message)}}).catch(()=>{i({type:"info",message:"Delete canceled"})})},_=async()=>{const l=await A();l.status==200?h.value=l.data:console.log(l.message)},L=l=>{const a=l.trim();return a===""?(i.error("请输入有效值"),!1):a};return J(async()=>{_()}),(l,a)=>{const n=u("el-button"),s=u("el-table-column"),y=u("el-table"),V=u("el-input"),U=u("el-card"),D=u("el-dialog");return P(),K(O,null,[c("div",ee,[c("div",ae,[e(U,null,{default:t(()=>[c("div",te,[le,c("div",null,[e(n,{class:"button",type:"success",onClick:a[0]||(a[0]=o=>{p.value=!0,m.value=""})},{default:t(()=>[d("添加分区")]),_:1})])]),e(y,{ref:"singleTableRef",data:T.value,style:{width:"100%"},height:"600"},{default:t(()=>[e(s,{type:"expand"},{default:t(o=>[c("div",oe,[e(y,{data:o.row.devices,border:""},{default:t(()=>[e(s,{type:"index"}),e(s,{label:"序列号",prop:"serialNumber"}),e(s,{label:"设备名",prop:"deviceName"}),e(s,{label:"设备类型",prop:"deviceType"}),e(s,{align:"right"},{default:t(g=>[e(n,{size:"small",type:"danger",text:"",onClick:ie=>E(g.$index,g.row)},{default:t(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:2},1032,["data"])])]),_:1}),e(s,{type:"index",width:"80"}),e(s,{prop:"value",label:"分区名",width:"480"}),e(s,{align:"right",width:"380"},{header:t(()=>[e(V,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=o=>b.value=o),size:"small",placeholder:"搜索 分区名"},null,8,["modelValue"])]),default:t(o=>[e(n,{size:"small",onClick:g=>N(o.row)},{default:t(()=>[d("编辑")]),_:2},1032,["onClick"]),e(n,{size:"small",type:"danger",onClick:g=>z(o.$index,o.row)},{default:t(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])]),e(D,{modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=o=>p.value=o),title:"新增分区",width:"30%","align-center":""},{footer:t(()=>[c("span",se,[e(n,{onClick:a[3]||(a[3]=o=>p.value=!1)},{default:t(()=>[d("取消")]),_:1}),e(n,{type:"primary",onClick:S},{default:t(()=>[d("确认")]),_:1})])]),default:t(()=>[e(V,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=o=>m.value=o),placeholder:"分区名称"},null,8,["modelValue"])]),_:1},8,["modelValue"]),e(D,{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=o=>v.value=o),title:"新增设备",width:"50%","align-center":""},{footer:t(()=>[c("span",ne,[e(n,{onClick:a[5]||(a[5]=o=>v.value=!1)},{default:t(()=>[d("取消")]),_:1}),e(n,{type:"primary",onClick:I},{default:t(()=>[d("确认")]),_:1})])]),default:t(()=>[e(y,{data:Q(C),style:{width:"100%",height:"500px"},onSelectionChange:$},{default:t(()=>[e(s,{type:"selection",width:"55"}),e(s,{type:"index"}),e(s,{label:"序列号",prop:"serialNumber"}),e(s,{label:"设备名",prop:"deviceName"}),e(s,{label:"设备类型",prop:"deviceType"}),e(s,{label:"分区",prop:"comboId"})]),_:1},8,["data"])]),_:1},8,["modelValue"])],64)}}});const ue=q(de,[["__scopeId","data-v-db73055a"]]);export{ue as default};
